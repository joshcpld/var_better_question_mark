# Model 2 additions
"fce",
"gfcf",
"exports",
"imports",
# Model 3 additions
"hfce",
"bi",
"di",
"gfce",
"pub_gfcf",
"emp",
"unemp",
"twi"
),
series_id = c(
# Model 1
"A2304402X", #GDP
"A2325846C", #inflation
"A84423050A", #rnu
# Model 2 additions
"A2304082X", #fce
"A2304110W", #gfcf
"A2304114F", #exports
"A2304115J", #imports
# Model 3 additions
"A2304081W", #hfce
"A2304095K", #bi
"A2304098T", #di
"A2304080V", #gfce
"A2304109L", #pub_gfcf
"A84423043C", #emp
"A84423046K", #unemp
"A3534043J" #twi
)) %>%
mutate(release = case_when(
variable == "cpi" ~ "cpi",
variable %in% c("rnu", "emp", "unemp") ~ "lfs",
TRUE ~ "na"
))
na_ids <- series_ids %>% filter(release == "na")
na_data <- map2_dfr(
na_ids$series_id,
na_ids$variable,
~{
read_abs(series_id = .x, metadata = FALSE) %>%
mutate(variable = .y) %>%
select(date, value, variable)
}
) %>%
pivot_wider(names_from = variable)
cpi_ids <- series_ids %>% filter(release == "cpi")
cpi_data <- map2_dfr(
cpi_ids$series_id,
cpi_ids$variable,
~{
read_abs(series_id = .x, metadata = FALSE) %>%
mutate(variable = .y) %>%
select(date, value, variable)
}
) %>%
pivot_wider(names_from = variable)
lfs_ids <- series_ids %>% filter(release == "lfs")
lfs_data <- map2_dfr(
lfs_ids$series_id,
lfs_ids$variable,
~{
read_abs(series_id = .x, metadata = FALSE) %>%
mutate(variable = .y) %>%
select(date, value, variable)
}
) %>%
na.omit()
lfs_data <- lfs_data %>%
mutate(quarter = ceiling_date(date, "quarter")) %>%
mutate(quarter = quarter %m-% months(1)) %>%
group_by(quarter, variable) %>%
summarise(value = mean(value)) %>%
ungroup() %>%
select(date = quarter, variable, value) %>%
filter(date > "1990-12-01")
lfs_data_old <- read_csv("data/lfs_historical.csv") %>%
mutate(date = dmy(date)) %>%
pivot_longer(-date, names_to = "variable") %>%
mutate(quarter = ceiling_date(date, "quarter")) %>%
mutate(quarter = quarter %m-% months(1)) %>%
group_by(quarter, variable) %>%
summarise(value = mean(value)) %>%
ungroup() %>%
select(date = quarter, variable, value) %>%
na.omit() %>%
filter(date <= "1990-12-01")
lfs_data <- lfs_data %>%
bind_rows(lfs_data_old) %>%
arrange(date) %>%
na.omit() %>%
pivot_wider(names_from = variable)
data <- na_data %>%
inner_join(lfs_data, by = "date") %>%
inner_join(cpi_data, by = "date")
write_csv(data, "data/data.csv")
View(data)
library(tidyverse)
library(urca)
source("2_stationarity_function.R")
source("2_stationarity_function.R")
data <- read_csv("data/data.csv")
model_1_data <- data %>%
select(date,gdp,rnu,cpi)
model_2_data <- data %>%
select(date, gdp, rnu, cpi, fce, gfcf, exports, imports)
model_3_data <- data %>%
select(date, gdp, cpi, exports, imports, hfce, bi, di, gfce, pub_gfcf, emp, unemp, twi) %>%
na.omit()
model_1_data %>%
pivot_longer(-date) %>%
ggplot(aes(date, value, colour = name)) + geom_line() + facet_wrap(~name, scales = "free")
model_1_data %>%
pivot_longer(-date) %>%
group_by(name) %>%
mutate(value = value - lag(value)) %>%
na.omit() %>%
ggplot(aes(x = date, y = value, colour = name)) +
geom_line() +
facet_wrap(~name, scales = "free")
model_2_data %>%
pivot_longer(-date) %>%
ggplot(aes(date, value, colour = name)) + geom_line() + facet_wrap(~name, scales = "free")
model_2_data %>%
pivot_longer(-date) %>%
group_by(name) %>%
mutate(value = value - lag(value)) %>%
na.omit() %>%
ggplot(aes(x = date, y = value, colour = name)) +
geom_line() +
facet_wrap(~name, scales = "free")
model_3_data %>%
pivot_longer(-date) %>%
ggplot(aes(date, value, colour = name)) + geom_line() + facet_wrap(~name, scales = "free")
model_3_data %>%
pivot_longer(-date) %>%
group_by(name) %>%
mutate(value = value - lag(value)) %>%
na.omit() %>%
ggplot(aes(x = date, y = value, colour = name)) +
geom_line() +
facet_wrap(~name, scales = "free")
model_1_stationarity_results <- stationarity_tests(model_1_data, diff_order = 0)
model_2_stationarity_results <- stationarity_tests(model_2_data, diff_order = 0)
model_3_stationarity_results <- stationarity_tests(model_3_data, diff_order = 0)
model_1_stationarity_results <- stationarity_tests(model_1_data, diff_order = 1)
model_2_stationarity_results <- stationarity_tests(model_2_data, diff_order = 1)
model_3_stationarity_results <- stationarity_tests(model_3_data, diff_order = 1)
library(tidyverse)
data <- read_csv("data/data.csv")
data <- read_csv("data/data.csv")
model_1_data <- data %>%
select(date,gdp,rnu,cpi)
model_2_data <- data %>%
select(date, gdp, rnu, cpi, fce, gfcf, exports, imports)
model_3_data <- data %>%
select(date, gdp, cpi, exports, imports, hfce, bi, di, gfce, pub_gfcf, emp, unemp, twi) %>%
na.omit()
library(vars) # We import this here because vars overrides dplyr's select function.
VARselect(model_1_data)
glimpse(model_1_data)
model_1_data %>% dplyr::select(-date) %>%
VARselect()
model_1_data %>%
dplyr::select(-date) %>%
VARselect(type = "const")
model_1_data %>%
dplyr::select(-date) %>%
VAR(p=2, type = "const")
model_1_data %>%
dplyr::select(-date) %>%
VAR(p=2, type = "const") %>%
serial.test(lags.bg = 2, type = "BG")
model_1_data %>%
dplyr::select(-date) %>%
VAR(p=3, type = "const") %>%
serial.test(lags.bg = 2, type = "BG")
model_1_data %>%
dplyr::select(-date) %>%
VAR(p=4, type = "const") %>%
serial.test(lags.bg = 2, type = "BG")
model_1_data %>%
dplyr::select(-date) %>%
VAR(p=5, type = "const") %>%
serial.test(lags.bg = 2, type = "BG")
model_1_data %>%
dplyr::select(-date) %>%
VAR(p=6, type = "const") %>%
serial.test(lags.bg = 2, type = "BG")
model_1_data %>%
dplyr::select(-date) %>%
VAR(p=7, type = "const") %>%
serial.test(lags.bg = 2, type = "BG")
model_1_data %>%
dplyr::select(-date) %>%
VAR(p=6, type = "const") %>%
serial.test(lags.bg = 2, type = "BG")
model_1 <- model_1_data %>%
dplyr:select(-date) %>%
VAR(p=7, type = "const")
library(tidyverse)
library(vars) # We import this here because vars overrides dplyr's select function.
model_1 <- model_1_data %>%
dplyr:select(-date) %>%
VAR(p=7, type = "const")
model_1 <- model_1_data %>%
dplyr::select(-date) %>%
VAR(p=7, type = "const")
model_2_data %>%
dplyr::select(-date) %>%
VARselect(type = "const")
model_1_data %>%
dplyr::select(-date) %>%
VAR(p=1, type = "const") %>%
serial.test(lags.bg = 2, type = "BG")
model_1_data %>%
dplyr::select(-date) %>%
VAR(p=1, type = "const") %>%
serial.test(lags.bg = 1, type = "BG")
model_1_data %>%
dplyr::select(-date) %>%
VAR(p=2, type = "const") %>%
serial.test(lags.bg = 2, type = "BG")
model_1_data %>%
dplyr::select(-date) %>%
VAR(p=3, type = "const") %>%
serial.test(lags.bg = 2, type = "BG")
model_1_data %>%
dplyr::select(-date) %>%
VAR(p=, type = "const") %>%
serial.test(lags.bg = 2, type = "BG")
model_1_data %>%
dplyr::select(-date) %>%
VAR(p=4, type = "const") %>%
serial.test(lags.bg = 2, type = "BG")
model_2_data %>%
dplyr::select(-date) %>%
VAR(p=1, type = "const") %>%
serial.test(lags.bg = 1, type = "BG")
model_2_data %>%
dplyr::select(-date) %>%
VARselect(type = "const")
model_2_data %>%
dplyr::select(-date) %>%
VAR(p=1, type = "const") %>%
serial.test(lags.bg = 1, type = "BG")
model_2_data %>%
dplyr::select(-date) %>%
VAR(p=3, type = "const") %>%
serial.test(lags.bg = 2, type = "BG")
model_2_data %>%
dplyr::select(-date) %>%
VAR(p=4, type = "const") %>%
serial.test(lags.bg = 2, type = "BG")
model_2_data %>%
dplyr::select(-date) %>%
VAR(p=5, type = "const") %>%
serial.test(lags.bg = 2, type = "BG")
model_2_data %>%
dplyr::select(-date) %>%
VAR(p=6, type = "const") %>%
serial.test(lags.bg = 2, type = "BG")
model_2_data %>%
dplyr::select(-date) %>%
VAR(p=7, type = "const") %>%
serial.test(lags.bg = 2, type = "BG")
model_2_data %>%
dplyr::select(-date) %>%
VAR(p=8, type = "const") %>%
serial.test(lags.bg = 2, type = "BG")
model_2_data %>%
dplyr::select(-date) %>%
VAR(p=8, type = "const") %>%
serial.test(lags.bg = 2, type = "BG")
model_2_data %>%
dplyr::select(-date) %>%
VAR(p=9, type = "const") %>%
serial.test(lags.bg = 2, type = "BG")
model_2_data %>%
dplyr::select(-date) %>%
VAR(p=10, type = "const") %>%
serial.test(lags.bg = 2, type = "BG")
model_2_data %>%
dplyr::select(-date) %>%
VAR(p=11, type = "const") %>%
serial.test(lags.bg = 2, type = "BG")
model_2_data %>%
dplyr::select(-date) %>%
VAR(p=12, type = "const") %>%
serial.test(lags.bg = 2, type = "BG")
model_2_data %>%
dplyr::select(-date) %>%
VAR(p=13, type = "const") %>%
serial.test(lags.bg = 2, type = "BG")
model_2_data %>%
dplyr::select(-date) %>%
VAR(p=14, type = "const") %>%
serial.test(lags.bg = 2, type = "BG")
model_2_data %>%
dplyr::select(-date) %>%
VAR(p=15, type = "const") %>%
serial.test(lags.bg = 2, type = "BG")
model_2_data %>%
dplyr::select(-date) %>%
VAR(p=16, type = "const") %>%
serial.test(lags.bg = 2, type = "BG")
model_2_data %>%
dplyr::select(-date) %>%
VAR(p=17, type = "const") %>%
serial.test(lags.bg = 2, type = "BG")
model_2_data %>%
dplyr::select(-date) %>%
VAR(p=18, type = "const") %>%
serial.test(lags.bg = 2, type = "BG")
model_2_data %>%
dplyr::select(-date) %>%
VAR(p=19, type = "const") %>%
serial.test(lags.bg = 2, type = "BG")
model_2_data %>%
dplyr::select(-date) %>%
VAR(p=1, type = "const") %>%
serial.test(lags.bg = 2, type = "BG")
model_2_data %>%
dplyr::select(-date) %>%
VAR(p=2, type = "const") %>%
serial.test(lags.bg = 2, type = "BG")
model_2_data %>%
dplyr::select(-date) %>%
VAR(p=3, type = "const") %>%
serial.test(lags.bg = 2, type = "BG")
model_2_data %>%
dplyr::select(-date) %>%
VAR(p=4, type = "const") %>%
serial.test(lags.bg = 2, type = "BG")
model_2_data %>%
dplyr::select(-date) %>%
VAR(p=5, type = "const") %>%
serial.test(lags.bg = 2, type = "BG")
model_2_data %>%
dplyr::select(-date) %>%
VAR(p=6, type = "const") %>%
serial.test(lags.bg = 2, type = "BG")
model_2_data %>%
dplyr::select(-date) %>%
VAR(p=7, type = "const") %>%
serial.test(lags.bg = 2, type = "BG")
model_1
summary(model_1)
model_2_data %>%
dplyr::select(-date) %>%
VARselect(type = "const")
model_2_data %>%
dplyr::select(-date) %>%
VAR(p=2, type = "const") %>%
serial.test(lags.bg = 1, type = "BG")
model_2_data %>%
dplyr::select(-date) %>%
VAR(p=3, type = "const") %>%
serial.test(lags.bg = 1, type = "BG")
model_2_data %>%
dplyr::select(-date) %>%
VAR(p=4, type = "const") %>%
serial.test(lags.bg = 1, type = "BG")
model_2_data %>%
dplyr::select(-date) %>%
VAR(p=5, type = "const") %>%
serial.test(lags.bg = 1, type = "BG")
model_2_data %>%
dplyr::select(-date) %>%
VAR(p=6, type = "const") %>%
serial.test(lags.bg = 1, type = "BG")
model_2_data %>%
dplyr::select(-date) %>%
VAR(p=7, type = "const") %>%
serial.test(lags.bg = 1, type = "BG")
model_2_data %>%
dplyr::select(-date) %>%
VAR(p=1, type = "const") %>%
serial.test(lags.bg = 2, type = "BG")
model_2_data %>%
dplyr::select(-date) %>%
VAR(p=2, type = "const") %>%
serial.test(lags.bg = 2, type = "BG")
model_2_data %>%
dplyr::select(-date) %>%
VAR(p=3, type = "const") %>%
serial.test(lags.bg = 2, type = "BG")
model_2_data %>%
dplyr::select(-date) %>%
VAR(p=4, type = "const") %>%
serial.test(lags.bg = 2, type = "BG")
model_2_data %>%
dplyr::select(-date) %>%
VAR(p=5, type = "const") %>%
serial.test(lags.bg = 2, type = "BG")
model_2_data %>%
dplyr::select(-date) %>%
VAR(p=6, type = "const") %>%
serial.test(lags.bg = 2, type = "BG")
model_2_data %>%
dplyr::select(-date) %>%
VAR(p=7, type = "const") %>%
serial.test(lags.bg = 2, type = "BG")
model_2_data %>%
dplyr::select(-date) %>%
VAR(p=8, type = "const") %>%
serial.test(lags.bg = 2, type = "BG")
model_2_data %>%
dplyr::select(-date) %>%
VAR(p=9, type = "const") %>%
serial.test(lags.bg = 2, type = "BG")
model_2_data %>%
dplyr::select(-date) %>%
VAR(p=10, type = "const") %>%
serial.test(lags.bg = 2, type = "BG")
model_2_data %>%
dplyr::select(-date) %>%
VAR(p=11, type = "const") %>%
serial.test(lags.bg = 2, type = "BG")
model_2_data %>%
dplyr::select(-date) %>%
VAR(p=12, type = "const") %>%
serial.test(lags.bg = 2, type = "BG")
model_2_data %>%
dplyr::select(-date) %>%
VAR(p=13, type = "const") %>%
serial.test(lags.bg = 2, type = "BG")
model_2_data %>%
dplyr::select(-date) %>%
VAR(p=14, type = "const") %>%
serial.test(lags.bg = 2, type = "BG")
model_2_data %>%
dplyr::select(-date) %>%
VAR(p=15, type = "const") %>%
serial.test(lags.bg = 2, type = "BG")
model_2_data %>%
dplyr::select(-date) %>%
VAR(p=16, type = "const") %>%
serial.test(lags.bg = 2, type = "BG")
model_2_data %>%
dplyr::select(-date) %>%
VAR(p=17, type = "const") %>%
serial.test(lags.bg = 2, type = "BG")
model_2_data %>%
dplyr::select(-date) %>%
VAR(p=18, type = "const") %>%
serial.test(lags.bg = 2, type = "BG")
model_2_data %>%
dplyr::select(-date) %>%
VAR(p=19, type = "const") %>%
serial.test(lags.bg = 2, type = "BG")
model_2_data %>%
dplyr::select(-date) %>%
VAR(p=20, type = "const") %>%
serial.test(lags.bg = 2, type = "BG")
?serial.test()
model_2_data %>%
dplyr::select(-date) %>%
VAR(p=7, type = "const") %>%
serial.test(lags.bg = 1, type = "BG") %>%
residuals() %>%
acf()
model_2_data %>%
dplyr::select(-date) %>%
VAR(p=7, type = "const") %>%
serial.test(lags.bg = 1, type = "BG") %>%
residuals() %>%
ts() %>%
acf()
model_2 <-  VAR(p=7, type = "const") %>%
serial.test(lags.bg = 1, type = "BG") %>%
residuals()
model_2 <-VAR(p=7, type = "const") %>%
residuals()
model_2 <- model_2_data %>%
dplyr::select(-date) %>%
VAR(p=7, type = "const") %>%
residuals()
model_2 <- model_2_data %>%
dplyr::select(-date) %>%
VAR(p=7, type = "const") %>%
residuals() %>%
acf()
serial.test(lags.bg = 1, type = "BG")
model_1_data %>%
dplyr::select(-date) %>%
VAR(p=7, type = "const") %>%
serial.test(lags.bg = 1, type = "BG")
model_1_data %>%
dplyr::select(-date) %>%
VAR(p=2, type = "const") %>%
serial.test(lags.bg = 1, type = "BG")
model_1_data %>%
dplyr::select(-date) %>%
VAR(p=3, type = "const") %>%
serial.test(lags.bg = 1, type = "BG")
model_1_data %>%
dplyr::select(-date) %>%
VAR(p=4, type = "const") %>%
serial.test(lags.bg = 1, type = "BG")
model_2_residual_acf <- model_2_data %>%
dplyr::select(-date) %>%
VAR(p=7, type = "const") %>%
residuals() %>%
acf()
View(model_3_data)
View(model_2_data)
